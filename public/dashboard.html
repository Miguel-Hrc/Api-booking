<html>

<head>
  <title>Dashboard</title>
  <link rel="stylesheet" href="/stylesheets/style.css">
</head>

<body>
  <h1>Application</h1>


  <h2>User</h2>


  <h3>Create User</h3>
  <form id="form_user">
    <label>User name :</label>
    <input name="name" type="text" id="name" placeholder="Jhon">
    <label>User firstname :</label>
    <input name="firstname" type="text" id="firstname" placeholder="Doe">
    <label>User email :</label>
    <input name="email" type="email" id="email" placeholder="JhonDoe@gmail.com">
    <label>Password :</label>
    <input name="password" type="password" id="password" placeholder="x42sasdffee-A">
    <button type="submit">Submit</button>
  </form>
  <div id="userCreateResponse"></div>

  <h3>Update User</h3>
  <form id="form_update_user">
    <label>User ID :</label>
    <input name="_id-toUpdate" type="text" id="_id-toUpdate" placeholder="677ffc9d6ae2970eb24fe0d2d">
    <label>User name :</label>
    <input name="name" type="text" id="update_name" placeholder="Jhon">
    <label>User firstname :</label>
    <input name="firstname" type="text" id="update_firstname" placeholder="Doe">
    <label>User email :</label>
    <input name="email" type="text" id="update_email" placeholder="JhonDoe@gmail.com">
    <label>Password :</label>
    <input name="password "type="password" id="update_password" placeholder="x42sasdffee-A">
    <button type="submit">Submit</button>
  </form>
  <div id="userUpdateResponse"></div>

  <h3>Delete User</h3>
  <form id="form_delete_user">
    <label>User ID :</label>
    <input name="_id-toDelete" type="text" id="_id-toDelete" placeholder="677ffc9d6ae2970eb24fe0d2d">
    <button type="submit">Submit</button>
  </form>
  <div id="userDeleteResponse"></div>
  
  <h2>Catway</h2>

  <h3>Create catway</h3>
  <form id="form_catway">
    <label>Catway number :</label>
    <input name="catwayNumber" type="number" id="catwayNumber" placeholder="1">
    <label>Catway type:</label>
    <select name="type" type="text" id="type">
      <option value="long">Long</option>
      <option value="short">Court</option>
    </select>
    <label>Catway state :</label>
    <input name="catwayState" type="text" id="catwayState" placeholder="Good condition">
    <button type="submit">Submit</button>
  </form>
  <div id="catwayCreateResponse"></div>

  <h3>Update catway</h3>
  <form id="form_update_catway">
    <label>ID catway :</label>
    <input name="_idCatway-toUpdate" type="text" id="_idCatway-toUpdate" placeholder="677ffc9d6ae2970eb24fe0d2d">
    <label>Catway state :</label>
    <input name="update_catwayState" type="text" id="update_catwayState" placeholder="Bad condition">
    <button type="submit">Submit</button>
  </form>
  <div id="catwayUpdateResponse"></div>

  <h3>Delete catway</h3>
  <form id="form_delete_catway">
    <label>ID catway :</label>
    <input name="_idCatway-toDelete" type="text" id="_idCatway-toDelete" placeholder="677ffc9d6ae2970eb24fe0d2d">
    <button type="submit">Submit</button>
  </form>
  <div id="catwayDeleteResponse"></div>

  <h3>Display catway</h3>
  <form id="form_display_catway">
    <label>ID catway :</label>
    <input name="_idCatway-toDisplay" type="text" id="_idCatway-toDisplay" placeholder="677ffc9d6ae2970eb24fe0d2d">
    <button type="submit">Submit</button>
  </form>
  <ul id="displayCatway"></ul>


  <h2>RÃ©servation</h2>


  <h3>Create reservation</h3>
  <form id="form_reservation">
    <label>ID catway :</label>
    <input name="_idCatway-toCreateReservation" type="text" id="_idCatway-toCreateReservation" placeholder="677ffc9d6ae2970eb24fe0d2d">
    <label>Client name :</label>
    <input name="clientName" type="text" id="clientName" placeholder="Jhon">
    <label>Boat name :</label>
    <input name="boatName" type="text" id="boatName" placeholder="BlackPearl">
    <label>Reservation from :</label>
    <input name="checkIn" type="date" id="checkIn">
    <label>to :</label>
    <input name="checkOut" type="date" id="checkOut">
    <button type="submit">Submit</button>
  </form>
  <div id="reservationCreateResponse"></div>

  <h3>Delete reservation</h3>
  <form id="form_delete_reservation">
    <label>ID catway :</label>
    <input name="_idCatway-toDeleteReservation" type="text" id="_idCatway-toDeleteReservation" placeholder="677ffc9d6ae2970eb24fe0d2d">
    <label>ID reservation :</label>
    <input name="_idReservation-toDeleteReservation" type="text" id="_idReservation-toDeleteReservation" placeholder="677ffc9d6ae2970eb24fe0d2d">
    <button type="submit">Submit</button>
  </form>
  <div id="reservationDeleteResponse"></div>

  <h3>Display reservation</h3>
  <form id="form_display_reservation">
    <label>ID catway :</label>
    <input name="_idCatway-toDisplayReservation" type="text" id="_idCatway-toDisplayReservation" placeholder="677ffc9d6ae2970eb24fe0d2d">
    <label>ID reservation :</label>
    <input name="_idReservation-toDisplayReservation" type="text" id="_idReservation-toDisplayReservation" placeholder="677ffc9d6ae2970eb24fe0d2d">
    <button type="submit">Submit</button>
  </form>
  <ul id="displayReservation"></ul>
  <a href="listCatway.html"><p>list of catway</p></a>
  <a href="listReservation.html"><p>list of reservation</p></a>


  <a href="doc.html"><h3>Documentation of the API</h3></a>

  <a href="index.html"><p>back</p></a>


</body>

<script>

const form_user = document.getElementById('form_user');
const userCreateResponse = document.getElementById('userCreateResponse');

  form_user.addEventListener('submit', function(e) {
  e.preventDefault();
  const name = document.getElementById('name').value;
  const password = document.getElementById('password').value;
  const email = document.getElementById('email').value;
  const firstname = document.getElementById('firstname').value;
  fetch('http://localhost:3000/auth/register', {
    method: "POST",
    body: JSON.stringify({ name, password, email, firstname }),
    headers: { 'Content-Type': 'application/json' },
  })
  .then(async (res) => {
    const data = await res.json();
    if (res.status === 201) {
      userCreateResponse.innerText = "User created !";
      userCreateResponse.style.color = "green";
    } else {
      userCreateResponse.innerText = `Error: ${data.message || 'Unknow Error'}`;
      userCreateResponse.style.color = "red";
    }
    })
    .catch(error => {
      userCreateResponse.innerText = `Network Error: ${error.message}`;
      userCreateResponse.style.color = "red";
    });
});


const form_update_user = document.getElementById('form_update_user');
const userUpdateResponse = document.getElementById('userUpdateResponse');

  form_update_user.addEventListener('submit', function(e){
    e.preventDefault();
    const id = document.getElementById('_id-toUpdate').value;
    const name = document.getElementById('update_name').value;
    const password = document.getElementById('update_password').value;
    const email = document.getElementById('update_email').value;
    const firstname = document.getElementById('update_firstname').value;
    const res = fetch(`http://localhost:3000/users/${id}`, {
      method: "PATCH",
      body:  JSON.stringify({name ,password, email, firstname}),
      headers: { 'Content-Type': 'application/json' },
    })
  .then(async (res) => {
    const data = await res.json();
    if (res.status === 200) {
      userUpdateResponse.innerText = "User updated !";
      userUpdateResponse.style.color = "green";
    } else {
      userUpdateResponse.innerText = `Error: ${data.message || 'Unknow Error'}`;
      userUpdateResponse.style.color = "red";
    }
    })
    .catch(error => {
      userUpdateResponse.innerText = `Network Error: ${error.message}`;
      userUpdateResponse.style.color = "red";
    });
});

const form_delete_user = document.getElementById('form_delete_user');
const userDeleteResponse = document.getElementById('userDeleteResponse');

  form_delete_user.addEventListener('submit', function(e){
    e.preventDefault();
    const id = document.getElementById('_id-toDelete').value;
    const res = fetch(`http://localhost:3000/users/${id}`, {
      method: "DELETE",
      headers: { 'Content-Type': 'application/json' },
    })
    .then(async (res) => {
    const data = await res.json();
    if (res.status === 200) {
      userDeleteResponse.innerText = "User deleted !";
      userDeleteResponse.style.color = "green";
    } else {
      userDeleteResponse.innerText = `Error: ${data.message || 'Unknow Error'}`;
      userDeleteResponse.style.color = "red";
    }
    })
    .catch(error => {
      userDeleteResponse.innerText = `Network Error: ${error.message}`;
      userDeleteResponse.style.color = "red";
    });
});

const form_catway = document.getElementById('form_catway');
const catwayCreateResponse = document.getElementById('catwayCreateResponse');

  form_catway.addEventListener('submit', function(e) {
    e.preventDefault();
    const catwayNumber = document.getElementById('catwayNumber').value;
    const type = document.getElementById('type').value;
    const catwayState = document.getElementById('catwayState').value;
    const res = fetch('http://localhost:3000/catways/', {
      method: "POST",
      body:  JSON.stringify({catwayNumber ,type, catwayState}),
      headers: { 'Content-Type': 'application/json' },
    })
    .then(async (res) => {
    const data = await res.json();
    if (res.status === 201) {
      catwayCreateResponse.innerText = "Catway Created !";
      catwayCreateResponse.style.color = "green";
    } else {
      catwayCreateResponse.innerText = `Error: ${data.message || 'Unknow Error'}`;
      catwayCreateResponse.style.color = "red";
    }
    })
    .catch(error => {
      catwayCreateResponse.innerText = `Network Error: ${error.message}`;
      catwayCreateResponse.style.color = "red";
    });
});

const form_update_catway = document.getElementById('form_update_catway');
const catwayUpdateResponse = document.getElementById('catwayUpdateResponse');

  form_update_catway.addEventListener('submit', function(e){
    e.preventDefault();
    const id = document.getElementById('_idCatway-toUpdate').value;
    const catwayState = document.getElementById('update_catwayState').value;
    const res = fetch(`http://localhost:3000/catways/${id}`, {
      method: "PATCH",
      body:  JSON.stringify({catwayNumber, catwayState}),
      headers: { 'Content-Type': 'application/json' },
    })
    .then(async (res) => {
    const data = await res.json();
    if (res.status === 200) {
      catwayUpdateResponse.innerText = "Catway Updated !";
      catwayUpdateResponse.style.color = "green";
    } else {
      catwayUpdateResponse.innerText = `Error: ${data.message || 'Unknow Error'}`;
      catwayUpdateResponse.style.color = "red";
    }
    })
    .catch(error => {
      catwayUpdateResponse.innerText = `Network Error: ${error.message}`;
      catwayUpdateResponse.style.color = "red";
    });
});

const form_delete_catway = document.getElementById('form_delete_catway');
const catwayDeleteResponse = document.getElementById('catwayDeleteResponse');

  form_delete_catway.addEventListener('submit', function(e){
    e.preventDefault();
    const id = document.getElementById('_idCatway-toDelete').value;
    const res = fetch(`http://localhost:3000/catways/${id}`, {
      method: "DELETE",
      headers: { 'Content-Type': 'application/json' },
    })
    .then(async (res) => {
    const data = await res.json();
    if (res.status === 200) {
      catwayDeleteResponse.innerText = "Catway Updated !";
      catwayDeleteResponse.style.color = "green";
    } else {
      catwayDeleteResponse.innerText = `Error: ${data.message || 'Unknow Error'}`;
      catwayDeleteResponse.style.color = "red";
    }
    })
    .catch(error => {
      catwayDeleteResponse.innerText = `Network Error: ${error.message}`;
      catwayDeleteResponse.style.color = "red";
    });
});

const form_display_catway = document.getElementById('form_display_catway');

form_display_catway.addEventListener('submit', function(e){
  e.preventDefault();
  const id = document.getElementById('_idCatway-toDisplay').value;
  const ul = document.getElementById('displayCatway'); 
  const list = document.createDocumentFragment();
  const url = `http://localhost:3000/catways/${id}`;
  fetch(url)
    .then((response) => response.json())
    .then((data) => {
      if (!data.success) {
        ul.innerHTML = '<li> Catway not found.</li>';
        return;
      }
      const catway = data.data;
      const li = document.createElement('li');
      const catwayNumber = document.createElement('p');
      const type = document.createElement('p');
      const catwayState = document.createElement('p');
      ul.innerHTML = ''; 
      catwayNumber.innerHTML = `Catway Number: ${catway.catwayNumber}`;
      type.innerHTML = `Type: ${catway.type}`;
      catwayState.innerHTML = `State: ${catway.catwayState}`;
      li.appendChild(catwayNumber);
      li.appendChild(type);
      li.appendChild(catwayState);
      list.appendChild(li);
      ul.appendChild(list);
    })
    .catch(error => {
      ul.innerHTML = `<li> Network Error: ${error.message}</li>`;
    });
});

const form_reservation = document.getElementById('form_reservation');
const reservationCreateResponse = document.getElementById('reservationCreateResponse');
  

  form_reservation.addEventListener('submit', function(e) {
    e.preventDefault();
    const id = document.getElementById('_idCatway-toCreateReservation').value;
    const clientName = document.getElementById('clientName').value;
    const catwayNumber = document.getElementById('catwayNumber').value;
    const boatName = document.getElementById('boatName').value;
    const checkIn = document.getElementById('checkIn').value;
    const checkOut = document.getElementById('checkOut').value;
    fetch(`http://localhost:3000/catways/${id}/reservations`, {
      method: "POST",
      body:  JSON.stringify({catwayNumber, clientName , boatName , checkIn , checkOut }),
      headers: { 'Content-Type': 'application/json' },
    })
    .then(async (res) => {
    const data = await res.json();
    if (res.status === 201) {
      reservationCreateResponse.innerText = "Reservation Created !";
      reservationCreateResponse.style.color = "green";
    } else {
      reservationCreateResponse.innerText = `Error: ${data.message || 'Unknow Error'}`;
      reservationCreateResponse.style.color = "red";
    }
    })
    .catch(error => {
      reservationCreateResponse.innerText = `Network Error: ${error.message}`;
      reservationCreateResponse.style.color = "red";
    });
});

const form_delete_reservation = document.getElementById('form_delete_reservation');
const reservationDeleteResponse = document.getElementById('reservationDeleteResponse');
  
  form_delete_reservation.addEventListener('submit', function(e){
    e.preventDefault();
    const id = document.getElementById('_idCatway-toDeleteReservation').value;
    const idReservation = document.getElementById('_idReservation-toDeleteReservation').value;
    const res = fetch(`http://localhost:3000/catways/${id}/reservations/${idReservation}`, {
      method: "DELETE",
      headers: { 'Content-Type': 'application/json' },
    })
    .then(async (res) => {
    const data = await res.json();
    if (res.status === 200) {
      reservationDeleteResponse.innerText = "Reservation deleted !";
      reservationDeleteResponse.style.color = "green";
    } else {
      reservationDeleteResponse.innerText = `Error: ${data.message || 'Unknow Error'}`;
      reservationDeleteResponse.style.color = "red";
    }
    })
    .catch(error => {
      reservationDeleteResponse.innerText = `Network Error: ${error.message}`;
      reservationDeleteResponse.style.color = "red";
    });
});

const form_display_reservation = document.getElementById('form_display_reservation');

form_display_reservation.addEventListener('submit', function(e){
  e.preventDefault();
  const id = document.getElementById('_idCatway-toDisplayReservation').value;
  const idReservation = document.getElementById('_idReservation-toDisplayReservation').value;
  const ul = document.getElementById('displayReservation'); 
  const list = document.createDocumentFragment();
  const url = `http://localhost:3000/catways/${id}/reservations/${idReservation}`;
  fetch(url)
    .then((response) => response.json())
    .then((data) => {
      if (!data.success) {
        ul.innerHTML = '<li> Reservation not found.</li>';
        return;
      }
      const reservation = data.data;
      const li = document.createElement('li');
      const catwayNumber = document.createElement('p');
      const clientName = document.createElement('p');
      const boatName = document.createElement('p');
      const checkIn = document.createElement('p');
      const checkOut = document.createElement('p');
      ul.innerHTML = ''; 
      catwayNumber.innerHTML = `Catway Number: ${reservation.catwayNumber}`;
      clientName.innerHTML = `Type: ${reservation.clientName}`;
      boatName.innerHTML = `State: ${reservation.boatName}`;
      checkIn.innerHTML = `State: ${reservation.checkIn}`;
      checkOut.innerHTML = `State: ${reservation.checkOut}`;
      li.appendChild(catwayNumber);
      li.appendChild(clientName);
      li.appendChild(boatName);
      li.appendChild(checkIn);
      li.appendChild(checkOut);
      list.appendChild(li);
      ul.appendChild(list);
    })
    .catch(error => {
      ul.innerHTML = `<li> Network Error: ${error.message}</li>`;
    });
});

</script>
</html>
